Взял в работу учебный датасет, содержащий информацию об объявлениях на Airbnb в Лондоне.
Использованные библиотеки:pandahouse (для связи с БД ClickHouse и написания SQL-запросов через Jupiter/Python), numpy, matplotlib, seaborn, pandas.
Что было сделано:
1. Подключился с помощью pandahouse к ClickHouse. В качестве проверки вывел количество строк в таблице ldn_listings;
2. Выгрузил из таблицы данные о цене в зависимости от типа жилья, отсортировал по возрастанию id, сгруппировал полученный датафрейм по типу жилья и посчитал 75-й перцентиль цены;
3. К данным о цене и типе комнаты дополнительно выгрузил данные о рейтинге жилья (review_scores_rating). Отфильтровал пустые значения review_scores_rating и сконвертировал эту колонку в тип float32;
4. Построил график рассеивания, который показал зависимость средней оценки от средней цены по типу жилья;
5. Проверил, какие способы верификации аккаунта использовали хозяева, предлагающие различные впечатления (experiences_offered != 'none');
6. Отсортировал данные по убыванию experiences_count и выгрузил первые 100 строк. Затем преобразовал данные с помощью pivot, поместив в индексы название района, столбцы – вид впечатления, а значения – число объявлений с таким впечатлением для каждого района. Визуализировал результат с помощью sns.heatmap() c палитрой cmap=sns.cubehelix_palette(as_cmap=True);
7. Выгрузил данные о ценах за ночь для разных типов жилья, для которых также доступен какой-либо вид впечатления;
8. Построил два графика, используя distplot из библиотеки seaborn: на первом отобразил исходные распределения цен для каждого типа жилья; на втором – логарифмированные значения (np.log());
9. Выгрузил данные о цене, типе жилья и дате первого отзыва, начиная со 2 января 2010 года. Используя библиотеку seaborn и функцию lineplot, построил график динамики средних цен на жилье (ось Y) в зависимости от типа комнаты (цвет линии, параметр 'hue') по годам (ось X) с сортировкой по годам.
